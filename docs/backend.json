{
  "entities": {
    "JobOrder": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "JobOrder",
      "type": "object",
      "description": "Represents a job order with client and job details.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Job Order entity."
        },
        "jobOrderNumber": {
          "type": "string",
          "description": "Unique job order number."
        },
        "clientId": {
          "type": "string",
          "description": "Reference to Client. (Relationship: Client 1:N JobOrder)"
        },
        "jobOrderDate": {
          "type": "string",
          "description": "Date the job order was created.",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the job to be performed."
        },
        "quantity": {
          "type": "number",
          "description": "Quantity of items or services for the job."
        },
        "amount": {
          "type": "number",
          "description": "Amount or price per item/service."
        },
        "totalAmount": {
          "type": "number",
          "description": "Total amount for the job order (calculated field)."
        },
        "remarks": {
          "type": "string",
          "description": "Additional remarks or notes related to the job order."
        }
      },
      "required": [
        "id",
        "clientId",
        "jobOrderNumber",
        "jobOrderDate",
        "description",
        "quantity",
        "amount",
        "totalAmount"
      ]
    },
    "Client": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Client",
      "type": "object",
      "description": "Represents a client with contact information.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Client entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the client."
        },
        "contactNumber": {
          "type": "string",
          "description": "Contact number of the client."
        }
      },
      "required": [
        "id",
        "name",
        "contactNumber"
      ]
    },
    "Expense": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Expense",
      "type": "object",
      "description": "Represents an expense record.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Expense entity."
        },
        "date": {
          "type": "string",
          "description": "Date the expense was incurred.",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "description": "Description of the expense."
        },
        "amount": {
          "type": "number",
          "description": "Amount of the expense."
        }
      },
      "required": [
        "id",
        "date",
        "description",
        "amount"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/clients/{clientId}",
        "definition": {
          "entityName": "Client",
          "schema": {
            "$ref": "#/backend/entities/Client"
          },
          "description": "Stores client information.  Each document represents a single client.",
          "params": [
            {
              "name": "clientId",
              "description": "Unique identifier for the client."
            }
          ]
        }
      },
      {
        "path": "/clients/{clientId}/jobOrders/{jobOrderId}",
        "definition": {
          "entityName": "JobOrder",
          "schema": {
            "$ref": "#/backend/entities/JobOrder"
          },
          "description": "Stores job orders associated with a specific client. Includes denormalized 'clientId' field for authorization independence.",
          "params": [
            {
              "name": "clientId",
              "description": "Unique identifier for the client."
            },
            {
              "name": "jobOrderId",
              "description": "Unique identifier for the job order."
            }
          ]
        }
      },
      {
        "path": "/expenses/{expenseId}",
        "definition": {
          "entityName": "Expense",
          "schema": {
            "$ref": "#/backend/entities/Expense"
          },
          "description": "Stores expense records.",
          "params": [
            {
              "name": "expenseId",
              "description": "Unique identifier for the expense."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to optimize for authorization independence, clarity, and scalability, following the principles of denormalization, structural segregation, and access modeling. Each collection is designed to support secure 'list' operations and enforce data integrity.\n\nClients are stored in a top-level `clients` collection. JobOrders are stored as subcollections of Clients to reflect the 1:N relationship. This structure ensures clear ownership and simplifies security rules. Expenses are stored in a top-level collection.\n\nAuthorization Independence: The `JobOrder` documents contain a denormalized `clientId` field, copied from the parent `Client` document. This eliminates the need for `get()` calls to the parent document during security rule evaluation, enabling atomic operations and easier debugging.\n\nQAPs Support: The segregation of data into collections based on entity type supports secure `list` operations. Security rules can be applied at the collection level to control access to `clients` and `expenses`."
  }
}